!function(t){t.widget("cc.sausage",{options:{page:".page",content:function(t){return'<span class="sausage-span">'+(t+1)+"</span>"}},_create:function(){var e=this.element;this.$outer=e,this.$inner=t.isWindow(this.element.get(0))?t("body"):e.children(":first-child"),this.$sausages=t('<div class="sausage-set"/>'),this.sausages=this.$sausages.get(0),this.offsets=[],this.$sausages.appendTo(this.$inner),this._trigger("create")},_init:function(){this.$outer.height()>=this.$inner.height()?this.destroy():(this.draw(),this._update(),this._events(),this._delegates(),this.$sausages.addClass("sausage-set-init"),this.blocked=!1,this._trigger("init"))},_events:function(){var t=this;t.hasScrolled=!1,t.$outer.bind("resize.sausage",function(){t.draw()}).bind("scroll.sausage",function(){t.hasScrolled=!0}),setInterval(function(){t.hasScrolled&&(t.hasScrolled=!1,t._update())},250)},_getCurrent:function(){var t=this.$outer.scrollTop()+this._getHandleHeight(this.$outer,this.$inner)/4;this.$outer.height(),this.$inner.height();var e=0;for(l=this.offsets.length;e<l&&this.offsets[e+1]&&!(t<=this.offsets[e])&&!(t>this.offsets[e]&&t<=this.offsets[e+1]);e++);return e},_delegates:function(){var e=this;e.$sausages.delegate(".sausage","hover",function(){e.blocked||t(this).toggleClass("sausage-hover")}).delegate(".sausage","click",function(i){if(i.preventDefault(),!e.blocked){var n=t(this),o=n.index(),r=e.$inner.find(e.options.page).eq(o).offset().top;e._scrollTo(r),e._trigger("onClick",i,{$sausage:n,i:o}),n.hasClass("current")||e._trigger("onUpdate",i,{$sausage:n,i:o})}})},_scrollTo:function(e){var i=this.$outer,n=Math.abs((this.offsets[this.current]-e)/2),n=1e3>n?n:1e3;this.$outer.get(0)===window&&(i=t("body, html, document")),i.stop(!0).animate({scrollTop:e},n)},_handleClick:function(){},_update:function(){i=this._getCurrent(),c="sausage-current",i===this.current||this.blocked||(this.current=i,this.$sausages.children().eq(i).addClass(c).siblings().removeClass(c),this._trigger("update"))},_getHandleHeight:function(t,e){var i=t.height(),n=e.height();return i/n*i},draw:function(){var t,e,i,n=this.$outer.height(),o=this.$inner.height(),r=this.$inner.find(this.options.page),s=[];this.offsets=[],this.count=r.length,this.$sausages.detach().empty();for(var a=0;a<this.count;a++)t=r.eq(a),e=t.offset(),i=e.top/o*n,s.push('<div class="sausage'+(a===this.current?" sausage-current":"")+'" style="height:'+t.outerHeight()/o*n+"px;top:"+i+'px;">'+this.options.content(a,t)+"</div>"),this.offsets.push(e.top);this.sausages.innerHTML=s.join(""),this.$sausages.appendTo(this.$inner)},block:function(){this.blocked=!0,this.$sausages.addClass("sausage-set-blocked")},unblock:function(){this.$sausages.removeClass("sausage-set-blocked"),this.blocked=!1},destroy:function(){this.$outer.unbind(".sausage"),this.$sausages.remove()}})}(jQuery);